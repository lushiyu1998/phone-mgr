(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Phones"],{"1f8b":function(e,t,n){},5101:function(e,t,n){"use strict";n.r(t);var c=n("7a23"),a=function(e){return Object(c["J"])("data-v-5a16c5fe"),e=e(),Object(c["H"])(),e},r={key:0},u=a((function(){return Object(c["n"])("h2",null,"手机列表",-1)})),o={class:"search"},i=Object(c["p"])(" 添加一条 "),s=Object(c["p"])("   "),l=Object(c["p"])("上传 Excel 添加"),b=["onClick"],d=["onClick"],O=["onClick"],p=Object(c["p"])("   "),j=["onClick"],f=Object(c["p"])("修改"),h=[f],v=Object(c["p"])("   "),m=["onClick"],w=Object(c["p"])("删除"),g=[w];function y(e,t,n,a,f,w){var y=Object(c["P"])("a-divider"),_=Object(c["P"])("a-input-search"),k=Object(c["P"])("a-button"),C=Object(c["P"])("a-upload"),q=Object(c["P"])("space-between"),P=Object(c["P"])("a-table"),U=Object(c["P"])("a-pagination"),x=Object(c["P"])("flex-end"),L=Object(c["P"])("a-card"),R=Object(c["P"])("add-one"),F=Object(c["P"])("update"),D=Object(c["Q"])("only-admin");return Object(c["G"])(),Object(c["m"])("div",null,[Object(c["q"])(L,{title:e.simple?"最近新添的手机":""},{default:Object(c["bb"])((function(){return[e.simple?Object(c["l"])("",!0):(Object(c["G"])(),Object(c["m"])("div",r,[u,Object(c["q"])(y),Object(c["q"])(q,null,{default:Object(c["bb"])((function(){return[Object(c["n"])("div",o,[Object(c["q"])(_,{placeholder:"根据手机名搜索","enter-button":"",value:e.keyword,"onUpdate:value":t[0]||(t[0]=function(t){return e.keyword=t}),onSearch:e.onSearch},null,8,["value","onSearch"]),e.isSearch?(Object(c["G"])(),Object(c["m"])("a",{key:0,href:"javascript:;",onClick:t[1]||(t[1]=function(){return e.backAll&&e.backAll.apply(e,arguments)})},"返回")):Object(c["l"])("",!0)]),Object(c["n"])("div",null,[Object(c["cb"])(Object(c["q"])(k,{onClick:t[2]||(t[2]=function(t){return e.show=!0})},{default:Object(c["bb"])((function(){return[i]})),_:1},512),[[D]]),s,Object(c["q"])(C,{onChange:e.onUploadChange,action:"http://localhost:3000/upload/file",headers:e.headers},{default:Object(c["bb"])((function(){return[Object(c["q"])(k,{type:"primary"},{default:Object(c["bb"])((function(){return[l]})),_:1})]})),_:1},8,["onChange","headers"])])]})),_:1}),Object(c["q"])(y)])),Object(c["q"])(P,{columns:e.columns,"data-source":e.list,pagination:!1,bordered:"",scroll:{x:"max-content"}},Object(c["o"])({publishDate:Object(c["bb"])((function(t){return[Object(c["p"])(Object(c["S"])(e.formatTimestamp(t.record.publishDate)),1)]})),classify:Object(c["bb"])((function(t){var n=t.record;return[Object(c["p"])(Object(c["S"])(e.getClassifyTitleById(n.classify)),1)]})),count:Object(c["bb"])((function(t){return[Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.updateCount("IN_COUNT",t.record)}},"入库",8,b),Object(c["p"])(" "+Object(c["S"])(t.record.count)+" ",1),Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.updateCount("OUT_COUNT",t.record)}},"出库",8,d)]})),_:2},[e.simple?void 0:{name:"actions",fn:Object(c["bb"])((function(t){return[Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.toDetail(t)}},"详情",8,O),p,Object(c["cb"])(Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.update(t)}},h,8,j),[[D]]),v,Object(c["cb"])(Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.remove(t)}},g,8,m),[[D]])]}))}]),1032,["columns","data-source"]),e.simple?Object(c["l"])("",!0):(Object(c["G"])(),Object(c["k"])(x,{key:1,style:{"margin-top":"24px"}},{default:Object(c["bb"])((function(){return[Object(c["q"])(U,{current:e.curPage,"onUpdate:current":t[3]||(t[3]=function(t){return e.curPage=t}),total:e.total,"page-size":10,onChange:e.setPage},null,8,["current","total","onChange"])]})),_:1}))]})),_:1},8,["title"]),Object(c["q"])(R,{show:e.show,"onUpdate:show":t[4]||(t[4]=function(t){return e.show=t}),classifyList:e.phoneClassifyList,onGetList:e.getList},null,8,["show","classifyList","onGetList"]),Object(c["q"])(F,{show:e.showUpdateModal,"onUpdate:show":t[5]||(t[5]=function(t){return e.showUpdateModal=t}),phone:e.curEditPhone,onUpdate:e.updateCurPhone},null,8,["show","phone","onUpdate"])])}var _=n("1da1"),k=(n("7db0"),n("d3b7"),n("99af"),n("96cf"),n("8e44")),C=n("6c02"),q=n("f64c"),P=n("ed3b"),U=n("b558"),x=n("e428"),L=n("f2fa"),R=n("e0c5");n("b0c0");function F(e,t,n,a,r,u){var o=Object(c["P"])("a-input"),i=Object(c["P"])("a-form-item"),s=Object(c["P"])("a-input-number"),l=Object(c["P"])("a-date-picker"),b=Object(c["P"])("a-select-option"),d=Object(c["P"])("a-select"),O=Object(c["P"])("a-form"),p=Object(c["P"])("a-modal");return Object(c["G"])(),Object(c["m"])("div",null,[Object(c["q"])(p,{title:"添加手机",visible:e.props.show,onOk:e.submit,onCancel:e.close},{default:Object(c["bb"])((function(){return[Object(c["q"])(O,{"label-col":{span:6},"wrapper-col":{span:12}},{default:Object(c["bb"])((function(){return[Object(c["q"])(i,{label:"手机名"},{default:Object(c["bb"])((function(){return[Object(c["q"])(o,{value:e.addForm.name,"onUpdate:value":t[0]||(t[0]=function(t){return e.addForm.name=t})},null,8,["value"])]})),_:1}),Object(c["q"])(i,{label:"价格"},{default:Object(c["bb"])((function(){return[Object(c["q"])(s,{value:e.addForm.price,"onUpdate:value":t[1]||(t[1]=function(t){return e.addForm.price=t}),min:0,max:999999999},null,8,["value"])]})),_:1}),Object(c["q"])(i,{label:"品牌"},{default:Object(c["bb"])((function(){return[Object(c["q"])(o,{value:e.addForm.author,"onUpdate:value":t[2]||(t[2]=function(t){return e.addForm.author=t})},null,8,["value"])]})),_:1}),Object(c["q"])(i,{label:"发售日期"},{default:Object(c["bb"])((function(){return[Object(c["q"])(l,{value:e.addForm.publishDate,"onUpdate:value":t[3]||(t[3]=function(t){return e.addForm.publishDate=t})},null,8,["value"])]})),_:1}),Object(c["q"])(i,{label:"分类"},{default:Object(c["bb"])((function(){return[Object(c["q"])(d,{value:e.addForm.classify,"onUpdate:value":t[4]||(t[4]=function(t){return e.addForm.classify=t}),style:{width:"120:px"}},{default:Object(c["bb"])((function(){return[(Object(c["G"])(!0),Object(c["m"])(c["b"],null,Object(c["N"])(e.store.phoneClassify,(function(e){return Object(c["G"])(),Object(c["k"])(b,{key:e._id,value:e._id},{default:Object(c["bb"])((function(){return[Object(c["p"])(Object(c["S"])(e.title),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),_:1}),Object(c["q"])(i,{label:"库存"},{default:Object(c["bb"])((function(){return[Object(c["q"])(o,{value:e.addForm.count,"onUpdate:value":t[5]||(t[5]=function(t){return e.addForm.count=t})},null,8,["value"])]})),_:1})]})),_:1})]})),_:1},8,["visible","onOk","onCancel"])])}var D=n("4360"),S={name:"",price:0,author:"",publishDate:0,classify:"",count:""},T=Object(c["r"])({props:{show:Boolean},setup:function(e,t){var n=Object(c["K"])(Object(x["a"])(S));D["a"].state.phoneClassify.length&&(n.classify=D["a"].state.phoneClassify[0]._id);var a=function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(){var c,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(x["a"])(n),c.publishDate=n.publishDate.valueOf(),e.next=4,k["g"].add(c);case 4:a=e.sent,Object(x["c"])(a).success((function(e,c){var a=c.data;Object.assign(n,S),q["a"].success(a.msg),t.emit("getList")}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){t.emit("update:show",!1)};return{addForm:n,submit:a,props:e,close:r,store:D["a"].state}}}),G=n("d959"),I=n.n(G);const M=I()(T,[["render",F]]);var N=M,B=n("e43c"),A=Object(c["r"])({components:{AddOne:N,Update:B["a"]},props:{simple:Boolean},setup:function(e){var t=Object(C["d"])(),n=[{title:"手机名",dataIndex:"name"},{title:"品牌",dataIndex:"author"},{title:"价格",dataIndex:"price"},{title:"库存",slots:{customRender:"count"}},{title:"发售日期",dataIndex:"publishDate",slots:{customRender:"publishDate"}},{title:"分类",slots:{customRender:"classify"}}];e.simple||n.push({title:"操作",slots:{customRender:"actions"}});var a=Object(c["L"])(!1),r=Object(c["L"])(!1),u=Object(c["L"])([]),o=Object(c["L"])(0),i=Object(c["L"])(1),s=Object(c["L"])(""),l=Object(c["L"])(!1),b=Object(c["L"])({}),d=function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k["g"].list({page:i.value,size:10,keyword:s.value});case 2:t=e.sent,Object(x["c"])(t).success((function(e){var t=e.data,n=t.list,c=t.total;u.value=n,o.value=c}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c["D"])(Object(_["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:d();case 1:case"end":return e.stop()}}),e)}))));var O=function(e){i.value=e,d()},p=function(){d(),l.value=Boolean(s.value)},j=function(){s.value="",l.value=!1,d()},f=function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(t){var n,c,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.text,c=n._id,e.next=4,k["g"].remove(c);case 4:a=e.sent,Object(x["c"])(a).success((function(e){var t=e.msg;q["a"].success(t),d()}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(e,t){var n="增加";"OUT_COUNT"===e&&(n="减少"),P["a"].confirm({title:"要".concat(n,"多少库存"),content:Object(c["q"])("div",null,[Object(c["q"])(U["a"],{class:"__phone_input_count"},null)]),onOk:function(){var c=Object(_["a"])(regeneratorRuntime.mark((function c(){var a,r,o;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return a=document.querySelector(".__phone_input_count"),r=a.value,c.next=4,k["g"].updateCount({id:t._id,num:r,type:e});case 4:o=c.sent,Object(x["c"])(o).success((function(c){r="IN_COUNT"===e?Math.abs(r):-Math.abs(r);var a=u.value.find((function(e){return e._id===t._id}));a&&(console.log(r),a.count=a.count+r,q["a"].success("成功".concat(n," ").concat(Math.abs(r),"台手机，要赚大钱啦")))}));case 6:case"end":return c.stop()}}),c)})));function a(){return c.apply(this,arguments)}return a}()})},v=function(e){var t=e.record;r.value=!0,b.value=t},m=function(e){Object.assign(b.value,e)},w=function(e){var n=e.record;t.push("/phones/".concat(n._id))},g=function(e){var t=e.file;t.response&&Object(x["c"])(t.response).success(function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k["g"].addMany(t);case 2:n=e.sent,Object(x["c"])(n).success((function(e){var t=e.data.addCount;q["a"].success("成功添加 ".concat(t," 部手机")),d()}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return{columns:n,show:a,list:u,formatTimestamp:x["b"],curPage:i,total:o,setPage:O,keyword:s,onSearch:p,backAll:j,isSearch:l,remove:f,updateCount:h,showUpdateModal:r,update:v,curEditPhone:b,updateCurPhone:m,toDetail:w,getList:d,getClassifyTitleById:R["a"],simple:e.simple,onUploadChange:g,headers:Object(L["c"])()}}});n("cb80");const E=I()(A,[["render",y],["__scopeId","data-v-5a16c5fe"]]);t["default"]=E},cb80:function(e,t,n){"use strict";n("1f8b")}}]);
//# sourceMappingURL=Phones.cbc2f43b.js.map